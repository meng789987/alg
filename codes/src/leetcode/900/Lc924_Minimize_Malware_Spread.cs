using System;
using System.Collections.Generic;
using System.Linq;

using alg;

/*
 * tags: disjointset
 * Time(n^2), Space(n)
 */
namespace leetcode
{
    public class Lc924_Minimize_Malware_Spread
    {
        public int MinMalwareSpread(int[][] graph, int[] initial)
        {
            var ds = new DisjointSet(graph.Length);
            for (int i = 0; i < graph.Length; i++)
                for (int j = i + 1; j < graph[i].Length; j++)
                    if (graph[i][j] == 1) ds.Union(i, j);

            int ret = initial[0];
            foreach (var i in initial)
            {
                if (ds.Size(ret) < ds.Size(i) || (ds.Size(ret) == ds.Size(i) && ret > i))
                    ret = i;
            }

            return ret;
        }

        class DisjointSet
        {
            public DisjointSet(int n)
            {
                _parents = new int[n];
                _sizes = new int[n];
                for (int i = 0; i < n; i++)
                {
                    _parents[i] = i;
                    _sizes[i] = 1;
                }
            }

            public void Union(int i, int j)
            {
                int pi = Find(i);
                int pj = Find(j);
                if (pi != pj)
                {
                    _parents[pi] = pj;
                    _sizes[pj] += _sizes[pi];
                }
            }

            public int Size(int i)
            {
                return _sizes[Find(i)];
            }

            int Find(int i)
            {
                if (_parents[i] != i)
                    _parents[i] = Find(_parents[i]);
                return _parents[i];
            }

            int[] _parents;
            int[] _sizes;
        }

        public void Test()
        {
            var graph = new int[][] { new int[] { 1, 1, 0 }, new int[] { 1, 1, 0 }, new int[] { 0, 0, 1 } };
            var initial = new int[] { 0, 1 };
            Console.WriteLine(MinMalwareSpread(graph, initial) == 0);

            graph = new int[][] { new int[] { 1, 0, 0 }, new int[] { 0, 1, 0 }, new int[] { 0, 0, 1 } };
            initial = new int[] { 0, 2 };
            Console.WriteLine(MinMalwareSpread(graph, initial) == 0);

            graph = new int[][] { new int[] { 1, 1, 1 }, new int[] { 1, 1, 1 }, new int[] { 1, 1, 1 } };
            initial = new int[] { 2, 1 };
            Console.WriteLine(MinMalwareSpread(graph, initial) == 1);
        }
    }
}

